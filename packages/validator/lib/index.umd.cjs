(function(u,O){typeof exports=="object"&&typeof module<"u"?O(exports):typeof define=="function"&&define.amd?define(["exports"],O):(u=typeof globalThis<"u"?globalThis:u||self,O(u.validator={}))})(this,function(u){"use strict";class O extends Error{}class wt extends Error{}const E=({x:t,y:e})=>`(${t}, ${e})`;var At=typeof global=="object"&&global&&global.Object===Object&&global,Ie=typeof self=="object"&&self&&self.Object===Object&&self,b=At||Ie||Function("return this")(),m=b.Symbol,Tt=Object.prototype,Ce=Tt.hasOwnProperty,Re=Tt.toString,D=m?m.toStringTag:void 0;function Me(t){var e=Ce.call(t,D),r=t[D];try{t[D]=void 0;var n=!0}catch{}var i=Re.call(t);return n&&(e?t[D]=r:delete t[D]),i}var je=Object.prototype,Le=je.toString;function Ne(t){return Le.call(t)}var De="[object Null]",Fe="[object Undefined]",Ot=m?m.toStringTag:void 0;function j(t){return t==null?t===void 0?Fe:De:Ot&&Ot in Object(t)?Me(t):Ne(t)}function $(t){return t!=null&&typeof t=="object"}var ze="[object Symbol]";function H(t){return typeof t=="symbol"||$(t)&&j(t)==ze}function mt(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var v=Array.isArray,Ge=1/0,$t=m?m.prototype:void 0,Pt=$t?$t.toString:void 0;function St(t){if(typeof t=="string")return t;if(v(t))return mt(t,St)+"";if(H(t))return Pt?Pt.call(t):"";var e=t+"";return e=="0"&&1/t==-Ge?"-0":e}var Be=/\s/;function He(t){for(var e=t.length;e--&&Be.test(t.charAt(e)););return e}var Ue=/^\s+/;function Ke(t){return t&&t.slice(0,He(t)+1).replace(Ue,"")}function L(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Et=NaN,Xe=/^[-+]0x[0-9a-f]+$/i,Ye=/^0b[01]+$/i,We=/^0o[0-7]+$/i,qe=parseInt;function Je(t){if(typeof t=="number")return t;if(H(t))return Et;if(L(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=L(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Ke(t);var r=Ye.test(t);return r||We.test(t)?qe(t.slice(2),r?2:8):Xe.test(t)?Et:+t}var xt=1/0,Ze=17976931348623157e292;function Qe(t){if(!t)return t===0?t:0;if(t=Je(t),t===xt||t===-xt){var e=t<0?-1:1;return e*Ze}return t===t?t:0}function It(t){var e=Qe(t),r=e%1;return e===e?r?e-r:e:0}function U(t){return t}var Ve="[object AsyncFunction]",ke="[object Function]",tr="[object GeneratorFunction]",er="[object Proxy]";function Ct(t){if(!L(t))return!1;var e=j(t);return e==ke||e==tr||e==Ve||e==er}var nt=b["__core-js_shared__"],Rt=function(){var t=/[^.]+$/.exec(nt&&nt.keys&&nt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function rr(t){return!!Rt&&Rt in t}var nr=Function.prototype,ir=nr.toString;function x(t){if(t!=null){try{return ir.call(t)}catch{}try{return t+""}catch{}}return""}var ar=/[\\^$.*+?()[\]{}|]/g,sr=/^\[object .+?Constructor\]$/,or=Function.prototype,ur=Object.prototype,fr=or.toString,cr=ur.hasOwnProperty,lr=RegExp("^"+fr.call(cr).replace(ar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function hr(t){if(!L(t)||rr(t))return!1;var e=Ct(t)?lr:sr;return e.test(x(t))}function pr(t,e){return t==null?void 0:t[e]}function I(t,e){var r=pr(t,e);return hr(r)?r:void 0}var it=I(b,"WeakMap"),Mt=Object.create,jt=function(){function t(){}return function(e){if(!L(e))return{};if(Mt)return Mt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function dr(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function at(){}var _r=4294967295;function F(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_r,this.__views__=[]}F.prototype=jt(at.prototype),F.prototype.constructor=F;function N(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}N.prototype=jt(at.prototype),N.prototype.constructor=N;function gr(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}function yr(t){if(t instanceof F)return t.clone();var e=new N(t.__wrapped__,t.__chain__);return e.__actions__=gr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var vr=Object.prototype,br=vr.hasOwnProperty;function K(t){if($(t)&&!v(t)&&!(t instanceof F)){if(t instanceof N)return t;if(br.call(t,"__wrapped__"))return yr(t)}return new N(t)}K.prototype=at.prototype,K.prototype.constructor=K;var wr=800,Ar=16,Tr=Date.now;function Or(t){var e=0,r=0;return function(){var n=Tr(),i=Ar-(n-r);if(r=n,i>0){if(++e>=wr)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function mr(t){return function(){return t}}var Lt=function(){try{var t=I(Object,"defineProperty");return t({},"",{}),t}catch{}}(),$r=Lt?function(t,e){return Lt(t,"toString",{configurable:!0,enumerable:!1,value:mr(e),writable:!0})}:U,Pr=Or($r);function Sr(t,e,r,n){for(var i=t.length,a=r+-1;++a<i;)if(e(t[a],a,t))return a;return-1}var Er=9007199254740991,xr=/^(?:0|[1-9]\d*)$/;function Nt(t,e){var r=typeof t;return e=e??Er,!!e&&(r=="number"||r!="symbol"&&xr.test(t))&&t>-1&&t%1==0&&t<e}function Dt(t,e){return t===e||t!==t&&e!==e}var Ft=Math.max;function Ir(t,e,r){return e=Ft(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=Ft(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(s),dr(t,this,o)}}function Cr(t,e){return Pr(Ir(t,e,U),t+"")}var Rr=9007199254740991;function st(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Rr}function X(t){return t!=null&&st(t.length)&&!Ct(t)}var Mr=Object.prototype;function jr(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Mr;return t===r}function ot(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Lr="[object Arguments]";function zt(t){return $(t)&&j(t)==Lr}var Gt=Object.prototype,Nr=Gt.hasOwnProperty,Dr=Gt.propertyIsEnumerable,Bt=zt(function(){return arguments}())?zt:function(t){return $(t)&&Nr.call(t,"callee")&&!Dr.call(t,"callee")};function Fr(){return!1}var Ht=typeof u=="object"&&u&&!u.nodeType&&u,Ut=Ht&&typeof module=="object"&&module&&!module.nodeType&&module,zr=Ut&&Ut.exports===Ht,Kt=zr?b.Buffer:void 0,Gr=Kt?Kt.isBuffer:void 0,ut=Gr||Fr,Br="[object Arguments]",Hr="[object Array]",Ur="[object Boolean]",Kr="[object Date]",Xr="[object Error]",Yr="[object Function]",Wr="[object Map]",qr="[object Number]",Jr="[object Object]",Zr="[object RegExp]",Qr="[object Set]",Vr="[object String]",kr="[object WeakMap]",tn="[object ArrayBuffer]",en="[object DataView]",rn="[object Float32Array]",nn="[object Float64Array]",an="[object Int8Array]",sn="[object Int16Array]",on="[object Int32Array]",un="[object Uint8Array]",fn="[object Uint8ClampedArray]",cn="[object Uint16Array]",ln="[object Uint32Array]",l={};l[rn]=l[nn]=l[an]=l[sn]=l[on]=l[un]=l[fn]=l[cn]=l[ln]=!0,l[Br]=l[Hr]=l[tn]=l[Ur]=l[en]=l[Kr]=l[Xr]=l[Yr]=l[Wr]=l[qr]=l[Jr]=l[Zr]=l[Qr]=l[Vr]=l[kr]=!1;function hn(t){return $(t)&&st(t.length)&&!!l[j(t)]}function pn(t){return function(e){return t(e)}}var Xt=typeof u=="object"&&u&&!u.nodeType&&u,z=Xt&&typeof module=="object"&&module&&!module.nodeType&&module,dn=z&&z.exports===Xt,ft=dn&&At.process,Yt=function(){try{var t=z&&z.require&&z.require("util").types;return t||ft&&ft.binding&&ft.binding("util")}catch{}}(),Wt=Yt&&Yt.isTypedArray,qt=Wt?pn(Wt):hn,_n=Object.prototype,gn=_n.hasOwnProperty;function yn(t,e){var r=v(t),n=!r&&Bt(t),i=!r&&!n&&ut(t),a=!r&&!n&&!i&&qt(t),s=r||n||i||a,o=s?ot(t.length,String):[],c=o.length;for(var f in t)gn.call(t,f)&&!(s&&(f=="length"||i&&(f=="offset"||f=="parent")||a&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||Nt(f,c)))&&o.push(f);return o}function vn(t,e){return function(r){return t(e(r))}}var bn=vn(Object.keys,Object),wn=Object.prototype,An=wn.hasOwnProperty;function Tn(t){if(!jr(t))return bn(t);var e=[];for(var r in Object(t))An.call(t,r)&&r!="constructor"&&e.push(r);return e}function Y(t){return X(t)?yn(t):Tn(t)}var On=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mn=/^\w*$/;function ct(t,e){if(v(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||H(t)?!0:mn.test(t)||!On.test(t)||e!=null&&t in Object(e)}var G=I(Object,"create");function $n(){this.__data__=G?G(null):{},this.size=0}function Pn(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Sn="__lodash_hash_undefined__",En=Object.prototype,xn=En.hasOwnProperty;function In(t){var e=this.__data__;if(G){var r=e[t];return r===Sn?void 0:r}return xn.call(e,t)?e[t]:void 0}var Cn=Object.prototype,Rn=Cn.hasOwnProperty;function Mn(t){var e=this.__data__;return G?e[t]!==void 0:Rn.call(e,t)}var jn="__lodash_hash_undefined__";function Ln(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=G&&e===void 0?jn:e,this}function C(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}C.prototype.clear=$n,C.prototype.delete=Pn,C.prototype.get=In,C.prototype.has=Mn,C.prototype.set=Ln;function Nn(){this.__data__=[],this.size=0}function W(t,e){for(var r=t.length;r--;)if(Dt(t[r][0],e))return r;return-1}var Dn=Array.prototype,Fn=Dn.splice;function zn(t){var e=this.__data__,r=W(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Fn.call(e,r,1),--this.size,!0}function Gn(t){var e=this.__data__,r=W(e,t);return r<0?void 0:e[r][1]}function Bn(t){return W(this.__data__,t)>-1}function Hn(t,e){var r=this.__data__,n=W(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function w(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}w.prototype.clear=Nn,w.prototype.delete=zn,w.prototype.get=Gn,w.prototype.has=Bn,w.prototype.set=Hn;var B=I(b,"Map");function Un(){this.size=0,this.__data__={hash:new C,map:new(B||w),string:new C}}function Kn(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function q(t,e){var r=t.__data__;return Kn(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Xn(t){var e=q(this,t).delete(t);return this.size-=e?1:0,e}function Yn(t){return q(this,t).get(t)}function Wn(t){return q(this,t).has(t)}function qn(t,e){var r=q(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function A(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}A.prototype.clear=Un,A.prototype.delete=Xn,A.prototype.get=Yn,A.prototype.has=Wn,A.prototype.set=qn;var Jn="Expected a function";function lt(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Jn);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(lt.Cache||A),r}lt.Cache=A;var Zn=500;function Qn(t){var e=lt(t,function(n){return r.size===Zn&&r.clear(),n}),r=e.cache;return e}var Vn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kn=/\\(\\)?/g,ti=Qn(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Vn,function(r,n,i,a){e.push(i?a.replace(kn,"$1"):n||r)}),e});function ei(t){return t==null?"":St(t)}function Jt(t,e){return v(t)?t:ct(t,e)?[t]:ti(ei(t))}var ri=1/0;function J(t){if(typeof t=="string"||H(t))return t;var e=t+"";return e=="0"&&1/t==-ri?"-0":e}function Zt(t,e){e=Jt(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[J(e[r++])];return r&&r==n?t:void 0}function ni(t,e,r){var n=t==null?void 0:Zt(t,e);return n===void 0?r:n}function ii(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function Qt(t){var e=K(t);return e.__chain__=!0,e}function ai(){this.__data__=new w,this.size=0}function si(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function oi(t){return this.__data__.get(t)}function ui(t){return this.__data__.has(t)}var fi=200;function ci(t,e){var r=this.__data__;if(r instanceof w){var n=r.__data__;if(!B||n.length<fi-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new A(n)}return r.set(t,e),this.size=r.size,this}function T(t){var e=this.__data__=new w(t);this.size=e.size}T.prototype.clear=ai,T.prototype.delete=si,T.prototype.get=oi,T.prototype.has=ui,T.prototype.set=ci;function Vt(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function li(){return[]}var hi=Object.prototype,pi=hi.propertyIsEnumerable,kt=Object.getOwnPropertySymbols,di=kt?function(t){return t==null?[]:(t=Object(t),Vt(kt(t),function(e){return pi.call(t,e)}))}:li;function _i(t,e,r){var n=e(t);return v(t)?n:ii(n,r(t))}function te(t){return _i(t,Y,di)}var ht=I(b,"DataView"),pt=I(b,"Promise"),dt=I(b,"Set"),ee="[object Map]",gi="[object Object]",re="[object Promise]",ne="[object Set]",ie="[object WeakMap]",ae="[object DataView]",yi=x(ht),vi=x(B),bi=x(pt),wi=x(dt),Ai=x(it),P=j;(ht&&P(new ht(new ArrayBuffer(1)))!=ae||B&&P(new B)!=ee||pt&&P(pt.resolve())!=re||dt&&P(new dt)!=ne||it&&P(new it)!=ie)&&(P=function(t){var e=j(t),r=e==gi?t.constructor:void 0,n=r?x(r):"";if(n)switch(n){case yi:return ae;case vi:return ee;case bi:return re;case wi:return ne;case Ai:return ie}return e});var se=b.Uint8Array,Ti="__lodash_hash_undefined__";function Oi(t){return this.__data__.set(t,Ti),this}function mi(t){return this.__data__.has(t)}function Z(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new A;++e<r;)this.add(t[e])}Z.prototype.add=Z.prototype.push=Oi,Z.prototype.has=mi;function oe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function $i(t,e){return t.has(e)}var Pi=1,Si=2;function ue(t,e,r,n,i,a){var s=r&Pi,o=t.length,c=e.length;if(o!=c&&!(s&&c>o))return!1;var f=a.get(t),d=a.get(e);if(f&&d)return f==e&&d==t;var p=-1,h=!0,_=r&Si?new Z:void 0;for(a.set(t,e),a.set(e,t);++p<o;){var g=t[p],y=e[p];if(n)var S=s?n(y,g,p,e,t,a):n(g,y,p,t,e,a);if(S!==void 0){if(S)continue;h=!1;break}if(_){if(!oe(e,function(R,M){if(!$i(_,M)&&(g===R||i(g,R,r,n,a)))return _.push(M)})){h=!1;break}}else if(!(g===y||i(g,y,r,n,a))){h=!1;break}}return a.delete(t),a.delete(e),h}function Ei(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function xi(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var Ii=1,Ci=2,Ri="[object Boolean]",Mi="[object Date]",ji="[object Error]",Li="[object Map]",Ni="[object Number]",Di="[object RegExp]",Fi="[object Set]",zi="[object String]",Gi="[object Symbol]",Bi="[object ArrayBuffer]",Hi="[object DataView]",fe=m?m.prototype:void 0,_t=fe?fe.valueOf:void 0;function Ui(t,e,r,n,i,a,s){switch(r){case Hi:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Bi:return!(t.byteLength!=e.byteLength||!a(new se(t),new se(e)));case Ri:case Mi:case Ni:return Dt(+t,+e);case ji:return t.name==e.name&&t.message==e.message;case Di:case zi:return t==e+"";case Li:var o=Ei;case Fi:var c=n&Ii;if(o||(o=xi),t.size!=e.size&&!c)return!1;var f=s.get(t);if(f)return f==e;n|=Ci,s.set(t,e);var d=ue(o(t),o(e),n,i,a,s);return s.delete(t),d;case Gi:if(_t)return _t.call(t)==_t.call(e)}return!1}var Ki=1,Xi=Object.prototype,Yi=Xi.hasOwnProperty;function Wi(t,e,r,n,i,a){var s=r&Ki,o=te(t),c=o.length,f=te(e),d=f.length;if(c!=d&&!s)return!1;for(var p=c;p--;){var h=o[p];if(!(s?h in e:Yi.call(e,h)))return!1}var _=a.get(t),g=a.get(e);if(_&&g)return _==e&&g==t;var y=!0;a.set(t,e),a.set(e,t);for(var S=s;++p<c;){h=o[p];var R=t[h],M=e[h];if(n)var xe=s?n(M,R,h,e,t,a):n(R,M,h,t,e,a);if(!(xe===void 0?R===M||i(R,M,r,n,a):xe)){y=!1;break}S||(S=h=="constructor")}if(y&&!S){var et=t.constructor,rt=e.constructor;et!=rt&&"constructor"in t&&"constructor"in e&&!(typeof et=="function"&&et instanceof et&&typeof rt=="function"&&rt instanceof rt)&&(y=!1)}return a.delete(t),a.delete(e),y}var qi=1,ce="[object Arguments]",le="[object Array]",Q="[object Object]",Ji=Object.prototype,he=Ji.hasOwnProperty;function Zi(t,e,r,n,i,a){var s=v(t),o=v(e),c=s?le:P(t),f=o?le:P(e);c=c==ce?Q:c,f=f==ce?Q:f;var d=c==Q,p=f==Q,h=c==f;if(h&&ut(t)){if(!ut(e))return!1;s=!0,d=!1}if(h&&!d)return a||(a=new T),s||qt(t)?ue(t,e,r,n,i,a):Ui(t,e,c,r,n,i,a);if(!(r&qi)){var _=d&&he.call(t,"__wrapped__"),g=p&&he.call(e,"__wrapped__");if(_||g){var y=_?t.value():t,S=g?e.value():e;return a||(a=new T),i(y,S,r,n,a)}}return h?(a||(a=new T),Wi(t,e,r,n,i,a)):!1}function gt(t,e,r,n,i){return t===e?!0:t==null||e==null||!$(t)&&!$(e)?t!==t&&e!==e:Zi(t,e,r,n,gt,i)}var Qi=1,Vi=2;function ki(t,e,r,n){var i=r.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var s=r[i];if(s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){s=r[i];var o=s[0],c=t[o],f=s[1];if(s[2]){if(c===void 0&&!(o in t))return!1}else{var d=new T,p;if(!(p===void 0?gt(f,c,Qi|Vi,n,d):p))return!1}}return!0}function pe(t){return t===t&&!L(t)}function ta(t){for(var e=Y(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,pe(i)]}return e}function de(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function ea(t){var e=ta(t);return e.length==1&&e[0][2]?de(e[0][0],e[0][1]):function(r){return r===t||ki(r,t,e)}}function ra(t,e){return t!=null&&e in Object(t)}function na(t,e,r){e=Jt(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=J(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&st(i)&&Nt(s,i)&&(v(t)||Bt(t)))}function ia(t,e){return t!=null&&na(t,e,ra)}var aa=1,sa=2;function oa(t,e){return ct(t)&&pe(e)?de(J(t),e):function(r){var n=ni(r,t);return n===void 0&&n===e?ia(r,t):gt(e,n,aa|sa)}}function _e(t){return function(e){return e==null?void 0:e[t]}}function ua(t){return function(e){return Zt(e,t)}}function fa(t){return ct(t)?_e(J(t)):ua(t)}function yt(t){return typeof t=="function"?t:t==null?U:typeof t=="object"?v(t)?oa(t[0],t[1]):ea(t):fa(t)}function ca(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var c=s[++i];if(r(a[c],c,a)===!1)break}return e}}var la=ca();function ha(t,e){return t&&la(t,e,Y)}function pa(t,e){return function(r,n){if(r==null)return r;if(!X(r))return t(r,n);for(var i=r.length,a=-1,s=Object(r);++a<i&&n(s[a],a,s)!==!1;);return r}}var da=pa(ha);function _a(t){return $(t)&&X(t)}function ga(t){return typeof t=="function"?t:U}function ya(t){return function(e,r,n){var i=Object(e);if(!X(e)){var a=yt(r);e=Y(e),r=function(o){return a(i[o],o,i)}}var s=t(e,r,n);return s>-1?i[a?e[s]:s]:void 0}}var va=Math.max;function ba(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:It(r);return i<0&&(i=va(n+i,0)),Sr(t,yt(e),i)}var V=ya(ba);function wa(t,e){var r;return da(t,function(n,i,a){return r=e(n,i,a),!r}),!!r}function Aa(t,e,r){var n=v(t)?oe:wa;return n(t,yt(e))}var Ta=9007199254740991,vt=4294967295,Oa=Math.min;function ma(t,e){if(t=It(t),t<1||t>Ta)return[];var r=vt,n=Oa(t,vt);e=ga(e),t-=vt;for(var i=ot(n,e);++r<t;)e(r);return i}var $a=Math.max;function Pa(t){if(!(t&&t.length))return[];var e=0;return t=Vt(t,function(r){if(_a(r))return e=$a(r.length,e),!0}),ot(e,function(r){return mt(t,_e(r))})}var ge=Cr(Pa);function ye({next:t}){return Qt(t).countBy(E).values().find(r=>r>1).value()?{errors:["agent-to-agent direct collision"]}:{}}const ve=(t,e)=>0<=e.x&&e.x<t.width&&0<=e.y&&e.y<t.height;function Sa({next:t,prev:e,domain:r,timestep:n}){const i=V(t,a=>!ve(r,a));return i?{errors:[`agent out of bounds, at timestep ${n}, position ${JSON.stringify(i)}`]}:{}}function Ea({next:t,domain:e,timestep:r}){const n=V(t,({x:i,y:a})=>e.cells[a][i]);return n?{errors:[`agent collision with environment, at timestep ${r}, position=${JSON.stringify(n)}`]}:{}}function be({actions:t,next:e,prev:r}){const n=Qt(r).map((a,s)=>({agent:s,point:a,action:t[s]})).keyBy(({point:a})=>E(a)).value();return V(e,(a,s)=>E(a)in n?t[s]!==n[E(a)].action:!1)?{errors:["agent-to-agent edge collision"]}:{}}function xa({current:t,goals:e}){return V(ge(t,e),([n,i])=>E(n)!==E(i))?{errors:["agent did not reach goal"]}:{}}class Ia{constructor(e){this.item=e}next(){const e=this.item;return e?(this.item=e.next,{value:e,done:!1}):{value:null,done:!0}}}class k{constructor(){this.next,this.prev,this.list}append(e){const r=this.list;if(!e||!e.append||!e.prepend||!e.detach)throw new Error("An argument without append, prepend, or detach methods was given to `Item#append`.");return!r||this===e?!1:(e.detach(),this.next&&(e.next=this.next,this.next.prev=e),e.prev=this,e.list=r,this.next=e,(this===r.tail||!r.tail)&&(r.tail=e),r.size++,e)}prepend(e){const r=this.list;if(!e||!e.append||!e.prepend||!e.detach)throw new Error("An argument without append, prepend, or detach methods was given to `Item#prepend`.");return!r||this===e?!1:(e.detach(),this.prev&&(e.prev=this.prev,this.prev.next=e),e.next=this,e.list=r,this.prev=e,this===r.head&&(r.head=e),r.tail||(r.tail=this),r.size++,e)}detach(){const e=this.list;return e?(e.tail===this&&(e.tail=this.prev),e.head===this&&(e.head=this.next),e.tail===e.head&&(e.tail=null),this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=null,this.next=null,this.list=null,e.size--,this):this}}k.prototype.next=null,k.prototype.prev=null,k.prototype.list=null;class tt{static from(e){const r=new this;return bt(r,e)}static of(...e){const r=new this;return bt(r,e)}constructor(...e){this.size,this.head,this.tail,bt(this,e)}append(e){if(!e)return!1;if(!e.append||!e.prepend||!e.detach)throw new Error("An argument without append, prepend, or detach methods was given to `List#append`.");return this.tail?this.tail.append(e):this.head?this.head.append(e):(e.detach(),e.list=this,this.head=e,this.size++,e)}prepend(e){if(!e)return!1;if(!e.append||!e.prepend||!e.detach)throw new Error("An argument without append, prepend, or detach methods was given to `List#prepend`.");return this.head?this.head.prepend(e):(e.detach(),e.list=this,this.head=e,this.size++,e)}toArray(){let e=this.head;const r=[];for(;e;)r.push(e),e=e.next;return r}[Symbol.iterator](){return new Ia(this.head)}}tt.prototype.size=0,tt.prototype.tail=null,tt.prototype.head=null;function bt(t,e){if(!e)return t;if(e[Symbol.iterator]){const r=e[Symbol.iterator]();let n;for(;(n=r.next())&&!n.done;)t.append(n.value)}else{let r=-1;for(;++r<e.length;){const n=e[r];t.append(n)}}return t}class we extends k{constructor(e,r,n){super(),this.count=e,this.symbol=r,this.offset=n}}class Ae{constructor(e){this.offset=0,this.chunks=e.matchAll(/(\d*)([a-z])/g)}read(){const{value:e,done:r}=this.chunks.next();if(r)throw new O;{const[,n,i]=e,a=n?+n:1,s=new we(a,i,this.offset);return this.offset+=a,s}}}class Te{constructor(e,r=2){this.reader=e,this.history=r,this.cache=new tt,this.current=e.read(),this.cache.append(this.current)}prune(){let e=this.current;ma(this.history,()=>this.current.prev&&(e=this.current.prev)),e.prev&&(e.prev=null)}seek(e){switch(Oe(e,this.current)){case"in-range":return this.current.symbol;case"low":{if(this.current.prev)return this.current=this.current.prev,this.seek(e);throw new wt}case"high":return this.current.next?(this.history!==-1&&this.prune(),this.current=this.current.next,this.seek(e)):(this.cache.append(this.reader.read()),this.seek(e))}}}function Oe(t,e){const r=e.offset,n=e.offset+e.count;return t<r?"low":r<=t&&t<n?"in-range":"high"}function me(t){const e=new Ae(t),r=new Te(e);return{seek:n=>{try{return r.seek(n)}catch(i){if(i instanceof O)return;throw i}},done:n=>{try{return r.seek(n),!1}catch(i){if(i instanceof O)return!0;throw i}}}}const $e={u:{x:0,y:-1},d:{x:0,y:1},l:{x:-1,y:0},r:{x:1,y:0}},Pe=(t,e)=>e.map(({seek:r})=>r(t)),Se=(t,e=$e)=>t.map(r=>e[r]??{x:0,y:0}),Ee=(t,e)=>ge(t,e).map(([r,n])=>({x:r.x+n.x,y:r.y+n.y}));function Ca({paths:t,domain:e,sources:r,goals:n=[],checks:i=[ye,be],finalChecks:a=[],onError:s=()=>!1}){var d,p;const o=t.map(me);let c=0,f=r;for(;Aa(o,h=>!h.done(c));){const h=Pe(c,o),_=Ee(f,Se(h));for(const g of i){const y=g({timestep:c,prev:f,next:_,actions:h,domain:e,sources:r,goals:n});if((d=y.errors)!=null&&d.length&&s(y))return!1}f=_,c++}for(const h of a){const _=h({timestep:c,current:f,domain:e,sources:r,goals:n});if((p=_.errors)!=null&&p.length&&s(_))return!1}}u.Chunk=we,u.DoneException=O,u.LowerOutOfRangeException=wt,u.Reader=Ae,u.Seeker=Te,u.checkDomainCollision=Ea,u.checkDomainOutOfBounds=Sa,u.checkEdgeCollision=be,u.checkGoalReached=xa,u.checkImmediateCollision=ye,u.checkRange=Oe,u.contains=ve,u.createActionMap=Pe,u.createOffsetMap=Se,u.defaultOffsetMap=$e,u.processAgent=me,u.serialisePoint=E,u.sumPositions=Ee,u.validate=Ca,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
