(function(f,x){typeof exports=="object"&&typeof module<"u"?x(exports):typeof define=="function"&&define.amd?define(["exports"],x):(f=typeof globalThis<"u"?globalThis:f||self,x(f.validator={}))})(this,function(f){"use strict";class x extends Error{}class wt extends Error{}const E=({x:t,y:e})=>`(${t}, ${e})`;var At=typeof global=="object"&&global&&global.Object===Object&&global,Ee=typeof self=="object"&&self&&self.Object===Object&&self,b=At||Ee||Function("return this")(),O=b.Symbol,Tt=Object.prototype,Se=Tt.hasOwnProperty,Ie=Tt.toString,D=O?O.toStringTag:void 0;function Ce(t){var e=Se.call(t,D),r=t[D];try{t[D]=void 0;var n=!0}catch{}var i=Ie.call(t);return n&&(e?t[D]=r:delete t[D]),i}var Re=Object.prototype,Me=Re.toString;function je(t){return Me.call(t)}var Le="[object Null]",Ne="[object Undefined]",Ot=O?O.toStringTag:void 0;function j(t){return t==null?t===void 0?Ne:Le:Ot&&Ot in Object(t)?Ce(t):je(t)}function P(t){return t!=null&&typeof t=="object"}var De="[object Symbol]";function H(t){return typeof t=="symbol"||P(t)&&j(t)==De}function Pt(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var v=Array.isArray,Fe=1/0,mt=O?O.prototype:void 0,$t=mt?mt.toString:void 0;function xt(t){if(typeof t=="string")return t;if(v(t))return Pt(t,xt)+"";if(H(t))return $t?$t.call(t):"";var e=t+"";return e=="0"&&1/t==-Fe?"-0":e}var ze=/\s/;function Ge(t){for(var e=t.length;e--&&ze.test(t.charAt(e)););return e}var Be=/^\s+/;function He(t){return t&&t.slice(0,Ge(t)+1).replace(Be,"")}function L(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Et=NaN,Ue=/^[-+]0x[0-9a-f]+$/i,Ke=/^0b[01]+$/i,Xe=/^0o[0-7]+$/i,Ye=parseInt;function We(t){if(typeof t=="number")return t;if(H(t))return Et;if(L(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=L(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=He(t);var r=Ke.test(t);return r||Xe.test(t)?Ye(t.slice(2),r?2:8):Ue.test(t)?Et:+t}var St=1/0,qe=17976931348623157e292;function Ze(t){if(!t)return t===0?t:0;if(t=We(t),t===St||t===-St){var e=t<0?-1:1;return e*qe}return t===t?t:0}function It(t){var e=Ze(t),r=e%1;return e===e?r?e-r:e:0}function U(t){return t}var Je="[object AsyncFunction]",Qe="[object Function]",Ve="[object GeneratorFunction]",ke="[object Proxy]";function Ct(t){if(!L(t))return!1;var e=j(t);return e==Qe||e==Ve||e==Je||e==ke}var rt=b["__core-js_shared__"],Rt=function(){var t=/[^.]+$/.exec(rt&&rt.keys&&rt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function tr(t){return!!Rt&&Rt in t}var er=Function.prototype,rr=er.toString;function S(t){if(t!=null){try{return rr.call(t)}catch{}try{return t+""}catch{}}return""}var nr=/[\\^$.*+?()[\]{}|]/g,ir=/^\[object .+?Constructor\]$/,ar=Function.prototype,sr=Object.prototype,or=ar.toString,ur=sr.hasOwnProperty,fr=RegExp("^"+or.call(ur).replace(nr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function cr(t){if(!L(t)||tr(t))return!1;var e=Ct(t)?fr:ir;return e.test(S(t))}function lr(t,e){return t==null?void 0:t[e]}function I(t,e){var r=lr(t,e);return cr(r)?r:void 0}var nt=I(b,"WeakMap"),Mt=Object.create,jt=function(){function t(){}return function(e){if(!L(e))return{};if(Mt)return Mt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function hr(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function it(){}var pr=4294967295;function F(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=pr,this.__views__=[]}F.prototype=jt(it.prototype),F.prototype.constructor=F;function N(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}N.prototype=jt(it.prototype),N.prototype.constructor=N;function dr(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}function _r(t){if(t instanceof F)return t.clone();var e=new N(t.__wrapped__,t.__chain__);return e.__actions__=dr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var gr=Object.prototype,yr=gr.hasOwnProperty;function K(t){if(P(t)&&!v(t)&&!(t instanceof F)){if(t instanceof N)return t;if(yr.call(t,"__wrapped__"))return _r(t)}return new N(t)}K.prototype=it.prototype,K.prototype.constructor=K;var vr=800,br=16,wr=Date.now;function Ar(t){var e=0,r=0;return function(){var n=wr(),i=br-(n-r);if(r=n,i>0){if(++e>=vr)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Tr(t){return function(){return t}}var Lt=function(){try{var t=I(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Or=Lt?function(t,e){return Lt(t,"toString",{configurable:!0,enumerable:!1,value:Tr(e),writable:!0})}:U,Pr=Ar(Or);function mr(t,e,r,n){for(var i=t.length,a=r+-1;++a<i;)if(e(t[a],a,t))return a;return-1}var $r=9007199254740991,xr=/^(?:0|[1-9]\d*)$/;function Nt(t,e){var r=typeof t;return e=e??$r,!!e&&(r=="number"||r!="symbol"&&xr.test(t))&&t>-1&&t%1==0&&t<e}function Dt(t,e){return t===e||t!==t&&e!==e}var Ft=Math.max;function Er(t,e,r){return e=Ft(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=Ft(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(s),hr(t,this,o)}}function Sr(t,e){return Pr(Er(t,e,U),t+"")}var Ir=9007199254740991;function at(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ir}function X(t){return t!=null&&at(t.length)&&!Ct(t)}var Cr=Object.prototype;function Rr(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Cr;return t===r}function st(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Mr="[object Arguments]";function zt(t){return P(t)&&j(t)==Mr}var Gt=Object.prototype,jr=Gt.hasOwnProperty,Lr=Gt.propertyIsEnumerable,Bt=zt(function(){return arguments}())?zt:function(t){return P(t)&&jr.call(t,"callee")&&!Lr.call(t,"callee")};function Nr(){return!1}var Ht=typeof f=="object"&&f&&!f.nodeType&&f,Ut=Ht&&typeof module=="object"&&module&&!module.nodeType&&module,Dr=Ut&&Ut.exports===Ht,Kt=Dr?b.Buffer:void 0,Fr=Kt?Kt.isBuffer:void 0,ot=Fr||Nr,zr="[object Arguments]",Gr="[object Array]",Br="[object Boolean]",Hr="[object Date]",Ur="[object Error]",Kr="[object Function]",Xr="[object Map]",Yr="[object Number]",Wr="[object Object]",qr="[object RegExp]",Zr="[object Set]",Jr="[object String]",Qr="[object WeakMap]",Vr="[object ArrayBuffer]",kr="[object DataView]",tn="[object Float32Array]",en="[object Float64Array]",rn="[object Int8Array]",nn="[object Int16Array]",an="[object Int32Array]",sn="[object Uint8Array]",on="[object Uint8ClampedArray]",un="[object Uint16Array]",fn="[object Uint32Array]",l={};l[tn]=l[en]=l[rn]=l[nn]=l[an]=l[sn]=l[on]=l[un]=l[fn]=!0,l[zr]=l[Gr]=l[Vr]=l[Br]=l[kr]=l[Hr]=l[Ur]=l[Kr]=l[Xr]=l[Yr]=l[Wr]=l[qr]=l[Zr]=l[Jr]=l[Qr]=!1;function cn(t){return P(t)&&at(t.length)&&!!l[j(t)]}function ln(t){return function(e){return t(e)}}var Xt=typeof f=="object"&&f&&!f.nodeType&&f,z=Xt&&typeof module=="object"&&module&&!module.nodeType&&module,hn=z&&z.exports===Xt,ut=hn&&At.process,Yt=function(){try{var t=z&&z.require&&z.require("util").types;return t||ut&&ut.binding&&ut.binding("util")}catch{}}(),Wt=Yt&&Yt.isTypedArray,qt=Wt?ln(Wt):cn,pn=Object.prototype,dn=pn.hasOwnProperty;function _n(t,e){var r=v(t),n=!r&&Bt(t),i=!r&&!n&&ot(t),a=!r&&!n&&!i&&qt(t),s=r||n||i||a,o=s?st(t.length,String):[],c=o.length;for(var u in t)dn.call(t,u)&&!(s&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Nt(u,c)))&&o.push(u);return o}function gn(t,e){return function(r){return t(e(r))}}var yn=gn(Object.keys,Object),vn=Object.prototype,bn=vn.hasOwnProperty;function wn(t){if(!Rr(t))return yn(t);var e=[];for(var r in Object(t))bn.call(t,r)&&r!="constructor"&&e.push(r);return e}function Y(t){return X(t)?_n(t):wn(t)}var An=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tn=/^\w*$/;function ft(t,e){if(v(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||H(t)?!0:Tn.test(t)||!An.test(t)||e!=null&&t in Object(e)}var G=I(Object,"create");function On(){this.__data__=G?G(null):{},this.size=0}function Pn(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var mn="__lodash_hash_undefined__",$n=Object.prototype,xn=$n.hasOwnProperty;function En(t){var e=this.__data__;if(G){var r=e[t];return r===mn?void 0:r}return xn.call(e,t)?e[t]:void 0}var Sn=Object.prototype,In=Sn.hasOwnProperty;function Cn(t){var e=this.__data__;return G?e[t]!==void 0:In.call(e,t)}var Rn="__lodash_hash_undefined__";function Mn(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=G&&e===void 0?Rn:e,this}function C(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}C.prototype.clear=On,C.prototype.delete=Pn,C.prototype.get=En,C.prototype.has=Cn,C.prototype.set=Mn;function jn(){this.__data__=[],this.size=0}function W(t,e){for(var r=t.length;r--;)if(Dt(t[r][0],e))return r;return-1}var Ln=Array.prototype,Nn=Ln.splice;function Dn(t){var e=this.__data__,r=W(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Nn.call(e,r,1),--this.size,!0}function Fn(t){var e=this.__data__,r=W(e,t);return r<0?void 0:e[r][1]}function zn(t){return W(this.__data__,t)>-1}function Gn(t,e){var r=this.__data__,n=W(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function w(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}w.prototype.clear=jn,w.prototype.delete=Dn,w.prototype.get=Fn,w.prototype.has=zn,w.prototype.set=Gn;var B=I(b,"Map");function Bn(){this.size=0,this.__data__={hash:new C,map:new(B||w),string:new C}}function Hn(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function q(t,e){var r=t.__data__;return Hn(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Un(t){var e=q(this,t).delete(t);return this.size-=e?1:0,e}function Kn(t){return q(this,t).get(t)}function Xn(t){return q(this,t).has(t)}function Yn(t,e){var r=q(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function A(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}A.prototype.clear=Bn,A.prototype.delete=Un,A.prototype.get=Kn,A.prototype.has=Xn,A.prototype.set=Yn;var Wn="Expected a function";function ct(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Wn);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(ct.Cache||A),r}ct.Cache=A;var qn=500;function Zn(t){var e=ct(t,function(n){return r.size===qn&&r.clear(),n}),r=e.cache;return e}var Jn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qn=/\\(\\)?/g,Vn=Zn(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Jn,function(r,n,i,a){e.push(i?a.replace(Qn,"$1"):n||r)}),e});function kn(t){return t==null?"":xt(t)}function Zt(t,e){return v(t)?t:ft(t,e)?[t]:Vn(kn(t))}var ti=1/0;function Z(t){if(typeof t=="string"||H(t))return t;var e=t+"";return e=="0"&&1/t==-ti?"-0":e}function Jt(t,e){e=Zt(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Z(e[r++])];return r&&r==n?t:void 0}function ei(t,e,r){var n=t==null?void 0:Jt(t,e);return n===void 0?r:n}function ri(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function Qt(t){var e=K(t);return e.__chain__=!0,e}function ni(){this.__data__=new w,this.size=0}function ii(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function ai(t){return this.__data__.get(t)}function si(t){return this.__data__.has(t)}var oi=200;function ui(t,e){var r=this.__data__;if(r instanceof w){var n=r.__data__;if(!B||n.length<oi-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new A(n)}return r.set(t,e),this.size=r.size,this}function T(t){var e=this.__data__=new w(t);this.size=e.size}T.prototype.clear=ni,T.prototype.delete=ii,T.prototype.get=ai,T.prototype.has=si,T.prototype.set=ui;function Vt(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function fi(){return[]}var ci=Object.prototype,li=ci.propertyIsEnumerable,kt=Object.getOwnPropertySymbols,hi=kt?function(t){return t==null?[]:(t=Object(t),Vt(kt(t),function(e){return li.call(t,e)}))}:fi;function pi(t,e,r){var n=e(t);return v(t)?n:ri(n,r(t))}function te(t){return pi(t,Y,hi)}var lt=I(b,"DataView"),ht=I(b,"Promise"),pt=I(b,"Set"),ee="[object Map]",di="[object Object]",re="[object Promise]",ne="[object Set]",ie="[object WeakMap]",ae="[object DataView]",_i=S(lt),gi=S(B),yi=S(ht),vi=S(pt),bi=S(nt),m=j;(lt&&m(new lt(new ArrayBuffer(1)))!=ae||B&&m(new B)!=ee||ht&&m(ht.resolve())!=re||pt&&m(new pt)!=ne||nt&&m(new nt)!=ie)&&(m=function(t){var e=j(t),r=e==di?t.constructor:void 0,n=r?S(r):"";if(n)switch(n){case _i:return ae;case gi:return ee;case yi:return re;case vi:return ne;case bi:return ie}return e});var se=b.Uint8Array,wi="__lodash_hash_undefined__";function Ai(t){return this.__data__.set(t,wi),this}function Ti(t){return this.__data__.has(t)}function J(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new A;++e<r;)this.add(t[e])}J.prototype.add=J.prototype.push=Ai,J.prototype.has=Ti;function oe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Oi(t,e){return t.has(e)}var Pi=1,mi=2;function ue(t,e,r,n,i,a){var s=r&Pi,o=t.length,c=e.length;if(o!=c&&!(s&&c>o))return!1;var u=a.get(t),d=a.get(e);if(u&&d)return u==e&&d==t;var p=-1,h=!0,_=r&mi?new J:void 0;for(a.set(t,e),a.set(e,t);++p<o;){var g=t[p],y=e[p];if(n)var $=s?n(y,g,p,e,t,a):n(g,y,p,t,e,a);if($!==void 0){if($)continue;h=!1;break}if(_){if(!oe(e,function(R,M){if(!Oi(_,M)&&(g===R||i(g,R,r,n,a)))return _.push(M)})){h=!1;break}}else if(!(g===y||i(g,y,r,n,a))){h=!1;break}}return a.delete(t),a.delete(e),h}function $i(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function xi(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var Ei=1,Si=2,Ii="[object Boolean]",Ci="[object Date]",Ri="[object Error]",Mi="[object Map]",ji="[object Number]",Li="[object RegExp]",Ni="[object Set]",Di="[object String]",Fi="[object Symbol]",zi="[object ArrayBuffer]",Gi="[object DataView]",fe=O?O.prototype:void 0,dt=fe?fe.valueOf:void 0;function Bi(t,e,r,n,i,a,s){switch(r){case Gi:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case zi:return!(t.byteLength!=e.byteLength||!a(new se(t),new se(e)));case Ii:case Ci:case ji:return Dt(+t,+e);case Ri:return t.name==e.name&&t.message==e.message;case Li:case Di:return t==e+"";case Mi:var o=$i;case Ni:var c=n&Ei;if(o||(o=xi),t.size!=e.size&&!c)return!1;var u=s.get(t);if(u)return u==e;n|=Si,s.set(t,e);var d=ue(o(t),o(e),n,i,a,s);return s.delete(t),d;case Fi:if(dt)return dt.call(t)==dt.call(e)}return!1}var Hi=1,Ui=Object.prototype,Ki=Ui.hasOwnProperty;function Xi(t,e,r,n,i,a){var s=r&Hi,o=te(t),c=o.length,u=te(e),d=u.length;if(c!=d&&!s)return!1;for(var p=c;p--;){var h=o[p];if(!(s?h in e:Ki.call(e,h)))return!1}var _=a.get(t),g=a.get(e);if(_&&g)return _==e&&g==t;var y=!0;a.set(t,e),a.set(e,t);for(var $=s;++p<c;){h=o[p];var R=t[h],M=e[h];if(n)var xe=s?n(M,R,h,e,t,a):n(R,M,h,t,e,a);if(!(xe===void 0?R===M||i(R,M,r,n,a):xe)){y=!1;break}$||($=h=="constructor")}if(y&&!$){var tt=t.constructor,et=e.constructor;tt!=et&&"constructor"in t&&"constructor"in e&&!(typeof tt=="function"&&tt instanceof tt&&typeof et=="function"&&et instanceof et)&&(y=!1)}return a.delete(t),a.delete(e),y}var Yi=1,ce="[object Arguments]",le="[object Array]",Q="[object Object]",Wi=Object.prototype,he=Wi.hasOwnProperty;function qi(t,e,r,n,i,a){var s=v(t),o=v(e),c=s?le:m(t),u=o?le:m(e);c=c==ce?Q:c,u=u==ce?Q:u;var d=c==Q,p=u==Q,h=c==u;if(h&&ot(t)){if(!ot(e))return!1;s=!0,d=!1}if(h&&!d)return a||(a=new T),s||qt(t)?ue(t,e,r,n,i,a):Bi(t,e,c,r,n,i,a);if(!(r&Yi)){var _=d&&he.call(t,"__wrapped__"),g=p&&he.call(e,"__wrapped__");if(_||g){var y=_?t.value():t,$=g?e.value():e;return a||(a=new T),i(y,$,r,n,a)}}return h?(a||(a=new T),Xi(t,e,r,n,i,a)):!1}function _t(t,e,r,n,i){return t===e?!0:t==null||e==null||!P(t)&&!P(e)?t!==t&&e!==e:qi(t,e,r,n,_t,i)}var Zi=1,Ji=2;function Qi(t,e,r,n){var i=r.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var s=r[i];if(s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){s=r[i];var o=s[0],c=t[o],u=s[1];if(s[2]){if(c===void 0&&!(o in t))return!1}else{var d=new T,p;if(!(p===void 0?_t(u,c,Zi|Ji,n,d):p))return!1}}return!0}function pe(t){return t===t&&!L(t)}function Vi(t){for(var e=Y(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,pe(i)]}return e}function de(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function ki(t){var e=Vi(t);return e.length==1&&e[0][2]?de(e[0][0],e[0][1]):function(r){return r===t||Qi(r,t,e)}}function ta(t,e){return t!=null&&e in Object(t)}function ea(t,e,r){e=Zt(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=Z(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&at(i)&&Nt(s,i)&&(v(t)||Bt(t)))}function ra(t,e){return t!=null&&ea(t,e,ta)}var na=1,ia=2;function aa(t,e){return ft(t)&&pe(e)?de(Z(t),e):function(r){var n=ei(r,t);return n===void 0&&n===e?ra(r,t):_t(e,n,na|ia)}}function _e(t){return function(e){return e==null?void 0:e[t]}}function sa(t){return function(e){return Jt(e,t)}}function oa(t){return ft(t)?_e(Z(t)):sa(t)}function gt(t){return typeof t=="function"?t:t==null?U:typeof t=="object"?v(t)?aa(t[0],t[1]):ki(t):oa(t)}function ua(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var c=s[++i];if(r(a[c],c,a)===!1)break}return e}}var fa=ua();function ca(t,e){return t&&fa(t,e,Y)}function la(t,e){return function(r,n){if(r==null)return r;if(!X(r))return t(r,n);for(var i=r.length,a=-1,s=Object(r);++a<i&&n(s[a],a,s)!==!1;);return r}}var ha=la(ca);function pa(t){return P(t)&&X(t)}function da(t){return typeof t=="function"?t:U}function _a(t){return function(e,r,n){var i=Object(e);if(!X(e)){var a=gt(r);e=Y(e),r=function(o){return a(i[o],o,i)}}var s=t(e,r,n);return s>-1?i[a?e[s]:s]:void 0}}var ga=Math.max;function ya(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:It(r);return i<0&&(i=ga(n+i,0)),mr(t,gt(e),i)}var yt=_a(ya);function va(t,e){var r;return ha(t,function(n,i,a){return r=e(n,i,a),!r}),!!r}function ba(t,e,r){var n=v(t)?oe:va;return n(t,gt(e))}var wa=9007199254740991,vt=4294967295,Aa=Math.min;function Ta(t,e){if(t=It(t),t<1||t>wa)return[];var r=vt,n=Aa(t,vt);e=da(e),t-=vt;for(var i=st(n,e);++r<t;)e(r);return i}var Oa=Math.max;function Pa(t){if(!(t&&t.length))return[];var e=0;return t=Vt(t,function(r){if(pa(r))return e=Oa(r.length,e),!0}),st(e,function(r){return Pt(t,_e(r))})}var ge=Sr(Pa);function ye({next:t}){return Qt(t).countBy(E).values().find(r=>r>1).value()?{errors:["agent-to-agent direct collision"]}:{}}function ma({next:t,domain:e}){return yt(t,({x:n,y:i})=>e.cells[i][n])?{errors:["agent collision with environment"]}:{}}function ve({actions:t,next:e,prev:r}){const n=Qt(r).map((a,s)=>({agent:s,point:a,action:t[s]})).keyBy(({point:a})=>E(a)).value();return yt(e,(a,s)=>E(a)in n?t[s]!==n[E(a)].action:!1)?{errors:["agent-to-agent edge collision"]}:{}}function $a({current:t,goals:e}){return yt(ge(t,e),([n,i])=>E(n)!==E(i))?{errors:["agent did not reach goal"]}:{}}class xa{constructor(e){this.item=e}next(){const e=this.item;return e?(this.item=e.next,{value:e,done:!1}):{value:null,done:!0}}}class V{constructor(){this.next,this.prev,this.list}append(e){const r=this.list;if(!e||!e.append||!e.prepend||!e.detach)throw new Error("An argument without append, prepend, or detach methods was given to `Item#append`.");return!r||this===e?!1:(e.detach(),this.next&&(e.next=this.next,this.next.prev=e),e.prev=this,e.list=r,this.next=e,(this===r.tail||!r.tail)&&(r.tail=e),r.size++,e)}prepend(e){const r=this.list;if(!e||!e.append||!e.prepend||!e.detach)throw new Error("An argument without append, prepend, or detach methods was given to `Item#prepend`.");return!r||this===e?!1:(e.detach(),this.prev&&(e.prev=this.prev,this.prev.next=e),e.next=this,e.list=r,this.prev=e,this===r.head&&(r.head=e),r.tail||(r.tail=this),r.size++,e)}detach(){const e=this.list;return e?(e.tail===this&&(e.tail=this.prev),e.head===this&&(e.head=this.next),e.tail===e.head&&(e.tail=null),this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=null,this.next=null,this.list=null,e.size--,this):this}}V.prototype.next=null,V.prototype.prev=null,V.prototype.list=null;class k{static from(e){const r=new this;return bt(r,e)}static of(...e){const r=new this;return bt(r,e)}constructor(...e){this.size,this.head,this.tail,bt(this,e)}append(e){if(!e)return!1;if(!e.append||!e.prepend||!e.detach)throw new Error("An argument without append, prepend, or detach methods was given to `List#append`.");return this.tail?this.tail.append(e):this.head?this.head.append(e):(e.detach(),e.list=this,this.head=e,this.size++,e)}prepend(e){if(!e)return!1;if(!e.append||!e.prepend||!e.detach)throw new Error("An argument without append, prepend, or detach methods was given to `List#prepend`.");return this.head?this.head.prepend(e):(e.detach(),e.list=this,this.head=e,this.size++,e)}toArray(){let e=this.head;const r=[];for(;e;)r.push(e),e=e.next;return r}[Symbol.iterator](){return new xa(this.head)}}k.prototype.size=0,k.prototype.tail=null,k.prototype.head=null;function bt(t,e){if(!e)return t;if(e[Symbol.iterator]){const r=e[Symbol.iterator]();let n;for(;(n=r.next())&&!n.done;)t.append(n.value)}else{let r=-1;for(;++r<e.length;){const n=e[r];t.append(n)}}return t}class be extends V{constructor(e,r,n){super(),this.count=e,this.symbol=r,this.offset=n}}class we{constructor(e){this.offset=0,this.chunks=e.matchAll(/(\d*)([a-z])/g)}read(){const{value:e,done:r}=this.chunks.next();if(r)throw new x;{const[n,i,a]=e,s=i?+i:1,o=new be(s,a,this.offset);return this.offset+=s,o}}}class Ae{constructor(e,r=2){this.reader=e,this.history=r,this.cache=new k,this.current=e.read(),this.cache.append(this.current)}prune(){let e=this.current;Ta(this.history,()=>this.current.prev&&(e=this.current.prev)),e.prev&&(e.prev=null)}seek(e){switch(Te(e,this.current)){case"in-range":return this.current.symbol;case"low":{if(this.current.prev)return this.current=this.current.prev,this.seek(e);throw new wt}case"high":return this.current.next?(this.history!==-1&&this.prune(),this.current=this.current.next,this.seek(e)):(this.cache.append(this.reader.read()),this.seek(e))}}}function Te(t,e){const r=e.offset,n=e.offset+e.count;return t<r?"low":r<=t&&t<n?"in-range":"high"}function Ea(t){const e=new we(t),r=new Ae(e);return{seek:n=>r.seek(n),done:n=>{try{return r.seek(n),!1}catch(i){if(i instanceof x)return!0;throw i}}}}const Oe={u:{x:0,y:-1},d:{x:0,y:1},l:{x:-1,y:0},r:{x:1,y:0}},Pe=(t,e)=>e.map(({seek:r})=>r(t)),me=(t,e=Oe)=>t.map(r=>e[r]??{x:0,y:0}),$e=(t,e)=>ge(t,e).map(([r,n])=>({x:r.x+n.x,y:r.y+n.y}));function Sa({paths:t,domain:e,sources:r,goals:n=[],checks:i=[ye,ve],finalChecks:a=[],onError:s=()=>!1}){var d,p;const o=t.map(Ea);let c=0,u=r;for(;ba(o,h=>!h.done(c));){const h=Pe(c,o),_=$e(u,me(h));for(const g of i){const y=g({timestep:c,prev:u,next:_,actions:h,domain:e,sources:r,goals:n});if((d=y.errors)!=null&&d.length&&s(y))return!1}u=_,c++}for(const h of a){const _=h({timestep:c,current:u,domain:e,sources:r,goals:n});if((p=_.errors)!=null&&p.length&&s(_))return!1}}f.Chunk=be,f.DoneException=x,f.LowerOutOfRangeException=wt,f.Reader=we,f.Seeker=Ae,f.checkDomainCollision=ma,f.checkEdgeCollision=ve,f.checkGoalReached=$a,f.checkImmediateCollision=ye,f.checkRange=Te,f.createActionMap=Pe,f.createOffsetMap=me,f.defaultOffsetMap=Oe,f.serialisePoint=E,f.sumPositions=$e,f.validate=Sa,Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});
